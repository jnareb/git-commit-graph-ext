<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.357">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="This is appendix for chapter 09_git.ipynb">

<title>git_commit_graph_ext - Exploring extraction of commit graphs from Git repositories, and examining their shape and stats</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="git_commit_graph_ext - Exploring extraction of commit graphs from Git repositories, and examining their shape and stats">
<meta property="og:description" content="This is appendix for chapter 09_git.ipynb">
<meta property="og:image" content="https://jnareb.github.io/git-commit-graph-ext/A.09_git_explore_files/figure-html/cell-38-output-1.png">
<meta property="og:site-name" content="git_commit_graph_ext">
<meta property="og:image:height" content="279">
<meta property="og:image:width" content="397">
<meta name="twitter:title" content="git_commit_graph_ext - Exploring extraction of commit graphs from Git repositories, and examining their shape and stats">
<meta name="twitter:description" content="This is appendix for chapter 09_git.ipynb">
<meta name="twitter:image" content="https://jnareb.github.io/git-commit-graph-ext/A.09_git_explore_files/figure-html/cell-38-output-1.png">
<meta name="twitter:image-height" content="279">
<meta name="twitter:image-width" content="397">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">git_commit_graph_ext</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./a.09_git_explore.html">Exploring extraction of commit graphs from Git repositories, and examining their shape and stats</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Commit graph labeling for speeding up Git commands</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graphs in Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./related.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Related works: various reachability labelings</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example_graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example directed graphs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reachability_index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reachability index</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./levels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Topological levels</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interval_labels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DFS Intervals Labelling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reach.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reachability queries</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extracting commit graphs from Git repositories</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./checkpoint.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Checkpointing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graph datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Large Git repositories</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reachability evaluation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a.09_git_explore.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Exploring extraction of commit graphs from Git repositories, and examining their shape and stats</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cloning-git.git-repository-and-extracting-and-saving-the-commit-graph" id="toc-cloning-git.git-repository-and-extracting-and-saving-the-commit-graph" class="nav-link active" data-scroll-target="#cloning-git.git-repository-and-extracting-and-saving-the-commit-graph">Cloning git.git repository, and extracting and saving the commit graph</a>
  <ul class="collapse">
  <li><a href="#testing-different-graph-output-formats" id="toc-testing-different-graph-output-formats" class="nav-link" data-scroll-target="#testing-different-graph-output-formats">Testing different graph output formats</a></li>
  <li><a href="#comparing-the-filesize-of-different-graph-output-formats" id="toc-comparing-the-filesize-of-different-graph-output-formats" class="nav-link" data-scroll-target="#comparing-the-filesize-of-different-graph-output-formats">Comparing the filesize of different graph output formats</a></li>
  <li><a href="#summary-of-findings" id="toc-summary-of-findings" class="nav-link" data-scroll-target="#summary-of-findings">Summary of findings</a></li>
  </ul></li>
  <li><a href="#examining-computing-and-storing-reachability-labels-and-other-per-node-data" id="toc-examining-computing-and-storing-reachability-labels-and-other-per-node-data" class="nav-link" data-scroll-target="#examining-computing-and-storing-reachability-labels-and-other-per-node-data">Examining computing and storing reachability labels and other per-node data</a>
  <ul class="collapse">
  <li><a href="#computing-reachability-labels-for-git.git-commit-graph" id="toc-computing-reachability-labels-for-git.git-commit-graph" class="nav-link" data-scroll-target="#computing-reachability-labels-for-git.git-commit-graph">Computing reachability labels for git.git commit graph</a></li>
  <li><a href="#visualizing-topological-level-stats-for-git.git-commit-graph" id="toc-visualizing-topological-level-stats-for-git.git-commit-graph" class="nav-link" data-scroll-target="#visualizing-topological-level-stats-for-git.git-commit-graph">Visualizing topological level stats for git.git commit graph</a></li>
  <li><a href="#visualizing-in-degree-and-out-degree-in-git.git-commit-graph" id="toc-visualizing-in-degree-and-out-degree-in-git.git-commit-graph" class="nav-link" data-scroll-target="#visualizing-in-degree-and-out-degree-in-git.git-commit-graph">Visualizing in-degree and out-degree in git.git commit graph</a></li>
  <li><a href="#visualizing-min-post-intervals-in-git.git-commit-graphs" id="toc-visualizing-min-post-intervals-in-git.git-commit-graphs" class="nav-link" data-scroll-target="#visualizing-min-post-intervals-in-git.git-commit-graphs">Visualizing min-post intervals in git.git commit graphs</a></li>
  <li><a href="#storing-computed-reachability-labels-and-related-stats" id="toc-storing-computed-reachability-labels-and-related-stats" class="nav-link" data-scroll-target="#storing-computed-reachability-labels-and-related-stats">Storing computed reachability labels and related stats</a></li>
  <li><a href="#summary-of-findings-1" id="toc-summary-of-findings-1" class="nav-link" data-scroll-target="#summary-of-findings-1">Summary of findings</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jnareb/git-commit-graph-ext/tree/master/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exploring extraction of commit graphs from Git repositories, and examining their shape and stats</h1>
</div>

<div>
  <div class="description">
    This is appendix for chapter <a href="./git.html"><code>09_git.ipynb</code></a>
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p>Necessary imports</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating graphs in Python</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calling git commands</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> subprocess</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># checking for existence of paths, and manipulating paths</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="cloning-git.git-repository-and-extracting-and-saving-the-commit-graph" class="level2">
<h2 class="anchored" data-anchor-id="cloning-git.git-repository-and-extracting-and-saving-the-commit-graph">Cloning git.git repository, and extracting and saving the commit graph</h2>
<p>Why it is important to use sparse clone - it is much faster, and takes up less space. For example for git.git repository we have the following (all times are wall time, and subject to interference from other CPU load): - full clone: 54s - mirror: 1min 19s - sparse: 14.9s - 19.4s</p>
<p>Prepare the directory to store repositories (note: <code>mkdir -d &lt;directory&gt;</code> should show no error if <code>&lt;directory&gt;</code> exists, but it is not portable).</p>
<p>Clone example repository (for exploration). Might give errors if repository already exists.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the directory to store cloned repositories, if it does not exist</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Path(<span class="st">"repos"</span>).mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>git <span class="op">-</span>C repos clone <span class="op">--</span>mirror <span class="op">--</span><span class="bu">filter</span><span class="op">=</span>tree:<span class="dv">0</span> <span class="op">--</span>quiet https:<span class="op">//</span>github.com<span class="op">/</span>git<span class="op">/</span>git.git</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wall time: 1.05 s</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>fatal: destination path 'git.git' already exists and is not an empty directory.</code></pre>
</div>
</div>
<p>Extract the history of the project</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create the directory to store datasets</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Path(<span class="st">"datasets"</span>).mkdir(exist_ok<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>git <span class="op">-</span>C repos<span class="op">/</span>git.git log <span class="op">--</span><span class="bu">format</span><span class="op">=</span><span class="st">"%h %p"</span> <span class="op">--</span>topo<span class="op">-</span>order <span class="op">--</span>branches <span class="op">&gt;</span>datasets<span class="op">/</span>git<span class="op">-</span>commit_graph.adjlist.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wall time: 6.81 s</code></pre>
</div>
</div>
<p>It takes a few seconds on a laptop with HDD to extract the commit graph (for all branches), storing results in a <code>git-commit_graph.adjlist.txt</code> text file in the adjacent list format in <code>datasets/</code> subdirectory</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>graph_git <span class="op">=</span> nx.read_adjlist(<span class="st">"datasets/git-commit_graph.adjlist.txt"</span>, create_using<span class="op">=</span>nx.DiGraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wall time: 663 ms</code></pre>
</div>
</div>
<p>It takes less than a second to create NetworkX graph for a commit graph</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'commit-graph of git repository graph has </span><span class="sc">{}</span><span class="st"> nodes and </span><span class="sc">{}</span><span class="st"> edges'</span>.<span class="bu">format</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>      graph_git.number_of_nodes(),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>      graph_git.number_of_edges()))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'is directed:   </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(graph_git.is_directed()))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'is DAG:        </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(nx.is_directed_acyclic_graph(graph_git)))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'example nodes: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="bu">list</span>(graph_git.nodes)[:<span class="dv">5</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>commit-graph of git repository graph has 63829 nodes and 79664 edges
is directed:   True
is DAG:        True
example nodes: ['836aadd78', 'a93475d10', '55fce44a3', '6d9d59c31', '084bd2a9a']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compress</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>403 ms ± 32 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
<p>It takes around 0.6-0.8 seconds to write it back gzip-compressed in the adjacency list format as <code>git-commit_graph.adjlist.txt.gz</code></p>
<section id="testing-different-graph-output-formats" class="level3">
<h3 class="anchored" data-anchor-id="testing-different-graph-output-formats">Testing different graph output formats</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#%%time</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#nx.write_graph6(graph_git, 'datasets/git-commit_graph.g6')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It turns out that the <a href="https://networkx.org/documentation/stable/reference/readwrite/sparsegraph6.html">graph6 / sparse6 format</a> is not a good choice for storing the commit graph for the following reasons: - NetworkX does not support digraph6 format; neither <code>write_graph6</code> not <code>write_sparse6</code> are implemented for directed graphs - the <a href="http://users.cecs.anu.edu.au/~bdm/data/formats.txt">digraph6 format</a> is dense graph format, storing the encoded adjacency matrix; there is no disparse6 or digraph6sparse format - SparseGraph6 formats do not store node/vertex names, which might be needed for future computations or visualizations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'edgelist.txt:            '</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'multiline_adjlist.txt:   '</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'edgelist.txt.gz:         '</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'multiline_adjlist.txt.gz:'</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'gexf.gz:                 '</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'graphml.gz:              '</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'pajek.gz:                '</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>edgelist.txt:             Wall time: 244 ms
multiline_adjlist.txt:    Wall time: 186 ms
edgelist.txt.gz:          Wall time: 819 ms
multiline_adjlist.txt.gz: Wall time: 1.06 s
gexf.gz:                  Wall time: 5.34 s
graphml.gz:               Wall time: 5.01 s
pajek.gz:                 Wall time: 3.14 s</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print('gpickle.gz:              ', end=' ', flush=True)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#%time nx.write_gpickle(graph_git, 'datasets/git-commit_graph.gpickle.gz')  # removed in NetworkX 3.x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>gpickle.gz:               </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'gpickle.gz:              '</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'datasets/git-commit_graph.gpickle.gz'</span>, <span class="st">'wb'</span>) <span class="im">as</span> f:</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    pickle.dump(graph_git, f, pickle.HIGHEST_PROTOCOL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>gpickle.gz:               Wall time: 273 ms</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>graph_git_df <span class="op">=</span> nx.to_pandas_edgelist(graph_git)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>graph_git_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">source</th>
<th data-quarto-table-cell-role="th">target</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>836aadd78</td>
<td>a93475d10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>836aadd78</td>
<td>55fce44a3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>a93475d10</td>
<td>df525e622</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>55fce44a3</td>
<td>6d9d59c31</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>6d9d59c31</td>
<td>084bd2a9a</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">79659</td>
<td>24778e335</td>
<td>19b2860cb</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">79660</td>
<td>19b2860cb</td>
<td>bf0c6e839</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">79661</td>
<td>bf0c6e839</td>
<td>e497ea2a9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">79662</td>
<td>e497ea2a9</td>
<td>8bc9a0c76</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">79663</td>
<td>8bc9a0c76</td>
<td>e83c51633</td>
</tr>
</tbody>
</table>

<p>79664 rows × 2 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>graph_git_df.to_pickle(<span class="st">'datasets/git-commit_graph.df_edgelist.pickle.gz'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wall time: 1.07 s</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>graph_git_df.to_csv(<span class="st">'datasets/git-commit_graph.df_edgelist.csv.gz'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wall time: 1.04 s</code></pre>
</div>
</div>
<p>Both <code>to_feather()</code> and <code>to_parquet()</code> need <code>pyarrow</code> module installed (the latter might use <code>fastparquet</code> instead)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    graph_git_df.to_feather(<span class="st">'datasets/git-commit_graph.df_edgelist.feather'</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Missing optional dependency 'pyarrow' required to save dataframe to the feather format"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wall time: 587 ms</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    graph_git_df.to_parquet(<span class="st">'datasets/git-commit_graph.df_edgelist.parquet'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Missing optional dependency 'pyarrow' or 'fastparquet' required to save dataframe to the parquet format"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wall time: 1.18 s</code></pre>
</div>
</div>
<p><code>to_hdf()</code> needs <code>tables</code> module installed (PyTables).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    graph_git_df.to_hdf(<span class="st">'datasets/git-commit_graph.df_edgelist.hdf5'</span>, <span class="st">'df_edgelist'</span>, mode<span class="op">=</span><span class="st">'w'</span>, complevel<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Missing optional dependency 'table' required to save dataframe to the HDF5 format"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wall time: 2.6 s</code></pre>
</div>
</div>
</section>
<section id="comparing-the-filesize-of-different-graph-output-formats" class="level3">
<h3 class="anchored" data-anchor-id="comparing-the-filesize-of-different-graph-output-formats">Comparing the filesize of different graph output formats</h3>
<p>Previously <code>!dir datasets</code> was used, but - it is not portable (on Linux it only lists files, instead of showing among others file size information) - on MS Windows where it works for this purpose, it includes unnecessary information</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">"</span><span class="sc">{name:&lt;50}</span><span class="st"> </span><span class="sc">{size:&gt;7}</span><span class="st">"</span>.<span class="bu">format</span>(name<span class="op">=</span>p.name,size<span class="op">=</span>p.stat().st_size) <span class="cf">for</span> p <span class="kw">in</span> Path(<span class="st">"datasets"</span>).glob(<span class="st">"git*.gz"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['git-commit_graph-df_reachability_sample.csv.gz      338527',
 'git-commit_graph.adjlist.txt.gz                     581624',
 'git-commit_graph.df_edgelist.csv.gz                 808989',
 'git-commit_graph.df_edgelist.pickle.gz              668474',
 'git-commit_graph.df_nodedata.csv.gz                 773957',
 'git-commit_graph.edgelist.txt.gz                    606109',
 'git-commit_graph.gexf.gz                           1524987',
 'git-commit_graph.gpickle.gz                        3851388',
 'git-commit_graph.graphml.gz                        1109122',
 'git-commit_graph.info.csv.gz                       1785780',
 'git-commit_graph.info.pickle.gz                    1467752',
 'git-commit_graph.multiline_adjlist.txt.gz           638575',
 'git-commit_graph.pajek.gz                           876408']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">"</span><span class="sc">{name:&lt;50}</span><span class="st"> </span><span class="sc">{size:&gt;7}</span><span class="st">"</span>.<span class="bu">format</span>(name<span class="op">=</span>p.name,size<span class="op">=</span>p.stat().st_size) <span class="cf">for</span> p <span class="kw">in</span> Path(<span class="st">"datasets"</span>).glob(<span class="st">"git*"</span>) <span class="cf">if</span> <span class="kw">not</span> p.match(<span class="st">"*.gz"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['git-commit_graph.adjlist.txt                       1434939',
 'git-commit_graph.df_edgelist.csv                   4383858',
 'git-commit_graph.df_edgelist.feather               1918282',
 'git-commit_graph.df_edgelist.hdf5                  2421869',
 'git-commit_graph.df_edgelist.parquet               1617488',
 'git-commit_graph.edgelist.txt                      1832272',
 'git-commit_graph.hdf5                              3803473',
 'git-commit_graph.info.hdf5                         1382956',
 'git-commit_graph.info.parquet                      3164039',
 'git-commit_graph.multiline_adjlist.txt             1801780']</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>the information below was gathered for <code>git log --all</code>, not <code>git log --branches</code> as it is done now, so the exact sizes will be different</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>csv <span class="op">=</span> <span class="st">u"""filename;size [bytes];size uncompressed [bytes];time [s]</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.adjlist.txt;2875179;2875179</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.adjlist.txt.gz;1173712;2875369;0.910</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.multiline_adjlist.txt;3610938;3610938;0.456</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.edgelist.txt;3692282;3692282;0.624</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.gpickle.gz;3254690;7712162;4.92</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.gexf.gz;3063783;16419236;9.49</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.graphml.gz;2231397;10305482;4.74</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.pajek.gz;1754236;6682509;6.74</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.df_edgelist.pickle.gz;1332691;2736191;1.9</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.df_edgelist.feather;3857818;3857818;0.487</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.df_edgelist.parquet;3116020;3116020;0.333</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.df_edgelist.csv;4383858;4383858</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.df_edgelist.csv.gz;1629263;4383858;1.2</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="st">git-commit_graph.df_edgelist.hdf5;3808521;5077784;0.244</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>csv_stream <span class="op">=</span> io.StringIO(csv)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>table_sizes<span class="op">=</span>pd.read_csv(csv_stream,sep<span class="op">=</span><span class="st">';'</span>) <span class="co"># ,index_col=0</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>table_sizes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">filename</th>
<th data-quarto-table-cell-role="th">size [bytes]</th>
<th data-quarto-table-cell-role="th">size uncompressed [bytes]</th>
<th data-quarto-table-cell-role="th">time [s]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>git-commit_graph.adjlist.txt</td>
<td>2875179</td>
<td>2875179</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>git-commit_graph.adjlist.txt.gz</td>
<td>1173712</td>
<td>2875369</td>
<td>0.910</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>git-commit_graph.multiline_adjlist.txt</td>
<td>3610938</td>
<td>3610938</td>
<td>0.456</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>git-commit_graph.edgelist.txt</td>
<td>3692282</td>
<td>3692282</td>
<td>0.624</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>git-commit_graph.gpickle.gz</td>
<td>3254690</td>
<td>7712162</td>
<td>4.920</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>git-commit_graph.gexf.gz</td>
<td>3063783</td>
<td>16419236</td>
<td>9.490</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>git-commit_graph.graphml.gz</td>
<td>2231397</td>
<td>10305482</td>
<td>4.740</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>git-commit_graph.pajek.gz</td>
<td>1754236</td>
<td>6682509</td>
<td>6.740</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>git-commit_graph.df_edgelist.pickle.gz</td>
<td>1332691</td>
<td>2736191</td>
<td>1.900</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>git-commit_graph.df_edgelist.feather</td>
<td>3857818</td>
<td>3857818</td>
<td>0.487</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>git-commit_graph.df_edgelist.parquet</td>
<td>3116020</td>
<td>3116020</td>
<td>0.333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>git-commit_graph.df_edgelist.csv</td>
<td>4383858</td>
<td>4383858</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>git-commit_graph.df_edgelist.csv.gz</td>
<td>1629263</td>
<td>4383858</td>
<td>1.200</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>git-commit_graph.df_edgelist.hdf5</td>
<td>3808521</td>
<td>5077784</td>
<td>0.244</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>table_sizes.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>filename                      object
size [bytes]                   int64
size uncompressed [bytes]      int64
time [s]                     float64
dtype: object</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>table_sizes.sort_values(by<span class="op">=</span><span class="st">'size [bytes]'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">filename</th>
<th data-quarto-table-cell-role="th">size [bytes]</th>
<th data-quarto-table-cell-role="th">size uncompressed [bytes]</th>
<th data-quarto-table-cell-role="th">time [s]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>git-commit_graph.adjlist.txt.gz</td>
<td>1173712</td>
<td>2875369</td>
<td>0.910</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>git-commit_graph.df_edgelist.pickle.gz</td>
<td>1332691</td>
<td>2736191</td>
<td>1.900</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>git-commit_graph.df_edgelist.csv.gz</td>
<td>1629263</td>
<td>4383858</td>
<td>1.200</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>git-commit_graph.pajek.gz</td>
<td>1754236</td>
<td>6682509</td>
<td>6.740</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>git-commit_graph.graphml.gz</td>
<td>2231397</td>
<td>10305482</td>
<td>4.740</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>git-commit_graph.adjlist.txt</td>
<td>2875179</td>
<td>2875179</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>git-commit_graph.gexf.gz</td>
<td>3063783</td>
<td>16419236</td>
<td>9.490</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>git-commit_graph.df_edgelist.parquet</td>
<td>3116020</td>
<td>3116020</td>
<td>0.333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>git-commit_graph.gpickle.gz</td>
<td>3254690</td>
<td>7712162</td>
<td>4.920</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>git-commit_graph.multiline_adjlist.txt</td>
<td>3610938</td>
<td>3610938</td>
<td>0.456</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>git-commit_graph.edgelist.txt</td>
<td>3692282</td>
<td>3692282</td>
<td>0.624</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>git-commit_graph.df_edgelist.hdf5</td>
<td>3808521</td>
<td>5077784</td>
<td>0.244</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>git-commit_graph.df_edgelist.feather</td>
<td>3857818</td>
<td>3857818</td>
<td>0.487</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>git-commit_graph.df_edgelist.csv</td>
<td>4383858</td>
<td>4383858</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>table_sizes.sort_values(by<span class="op">=</span><span class="st">'size uncompressed [bytes]'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">filename</th>
<th data-quarto-table-cell-role="th">size [bytes]</th>
<th data-quarto-table-cell-role="th">size uncompressed [bytes]</th>
<th data-quarto-table-cell-role="th">time [s]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>git-commit_graph.df_edgelist.pickle.gz</td>
<td>1332691</td>
<td>2736191</td>
<td>1.900</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>git-commit_graph.adjlist.txt</td>
<td>2875179</td>
<td>2875179</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>git-commit_graph.adjlist.txt.gz</td>
<td>1173712</td>
<td>2875369</td>
<td>0.910</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>git-commit_graph.df_edgelist.parquet</td>
<td>3116020</td>
<td>3116020</td>
<td>0.333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>git-commit_graph.multiline_adjlist.txt</td>
<td>3610938</td>
<td>3610938</td>
<td>0.456</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>git-commit_graph.edgelist.txt</td>
<td>3692282</td>
<td>3692282</td>
<td>0.624</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>git-commit_graph.df_edgelist.feather</td>
<td>3857818</td>
<td>3857818</td>
<td>0.487</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>git-commit_graph.df_edgelist.csv</td>
<td>4383858</td>
<td>4383858</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>git-commit_graph.df_edgelist.csv.gz</td>
<td>1629263</td>
<td>4383858</td>
<td>1.200</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>git-commit_graph.df_edgelist.hdf5</td>
<td>3808521</td>
<td>5077784</td>
<td>0.244</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>git-commit_graph.pajek.gz</td>
<td>1754236</td>
<td>6682509</td>
<td>6.740</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>git-commit_graph.gpickle.gz</td>
<td>3254690</td>
<td>7712162</td>
<td>4.920</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>git-commit_graph.graphml.gz</td>
<td>2231397</td>
<td>10305482</td>
<td>4.740</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>git-commit_graph.gexf.gz</td>
<td>3063783</td>
<td>16419236</td>
<td>9.490</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="summary-of-findings" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-findings">Summary of findings</h3>
<p><u>Storing DataFrame of edgelist data</u></p>
<p>The DataFrame is created using <code>nx.to_pandas_edgelist(graph)</code></p>
<p>The smallest file is the result of storing DataFrame of edgelist data as gzipped pickle (written using Pandas’ <code>to_pickle()</code>) - the <strong>*.df_edgelist.pickle.gz</strong> file.</p>
<ul>
<li>Advantages:
<ul>
<li>2nd smallest size</li>
<li>no extra modules to install</li>
<li>preserves types</li>
</ul></li>
<li>Disadvantages:
<ul>
<li>Python-specific</li>
<li>unsafe</li>
<li>slow (?)</li>
</ul></li>
</ul>
<p>Next smallest is, surprisingly, gzipped CSV representing DataFrame of edgelist data (written using Pandas’ <code>to_csv()</code>) - the <strong>*.df_edgelist.csv.gz</strong> file.</p>
<ul>
<li>Advantages:
<ul>
<li>3rd smallest size</li>
<li>no extra modules to install</li>
<li>universal format</li>
</ul></li>
<li>Disadvantages:
<ul>
<li>slow (?)</li>
</ul></li>
</ul>
<p>The fast interchange formats, <a href="https://github.com/wesm/feather">Feather</a> and <a href="https://parquet.apache.org/">Parquet</a> turned out to produce quite large files; they are however 4th smallest and 2nd smallest, respectively, among uncompressed formats.</p>
<p><strong><em>Feather</em></strong> provides a binary columnar serialization for data frames. It is designed to make reading and writing data frames efficient, and to make sharing data across data analysis languages easy.</p>
<p>Feather is designed to faithfully serialize and de-serialize <code>DataFrame</code>s, supporting all of the pandas dtypes, including extension dtypes such as categorical and datetime with tz.</p>
<p><strong><em>Apache Parquet</em></strong> provides a <em>partitioned</em> binary columnar serialization for data frames. It is designed to make reading and writing data frames efficient, and to make sharing data across data analysis languages easy. Parquet can use a variety of compression techniques (default is to use ‘snappy’) to shrink the file size as much as possible while still maintaining good read performance.</p>
<p>Parquet is designed to faithfully serialize and de-serialize <code>DataFrame</code>s, supporting all of the pandas dtypes, including extension dtypes such as datetime with tz.</p>
<ul>
<li>Advantages:
<ul>
<li>universal, cross language</li>
<li>preserves types</li>
<li>fast</li>
<li><a href="https://arrow.apache.org/docs/python/cuda.html">support for CUDA</a></li>
</ul></li>
<li>Disadvantages:
<ul>
<li>requires <code>pyarrow</code> package to be installed</li>
<li>quite large file size</li>
</ul></li>
</ul>
<p>The <strong><em>HDF5</em></strong> format has the advantage of being able to store multiple <code>DataFrame</code>s in a single file, for example one <code>DataFrame</code> to hold edgelist data to define the graph connections, and one <code>DataFrame</code> holding various per vertex (per node) rechablity index data. Unfortunately, even internally compressed it has one of larger file sizes (and largest compressed).</p>
<p><a href="https://portal.hdfgroup.org/display/HDF5/HDF5">Hierarchical Data Format (HDF)</a> is self-describing, allowing an application to interpret the structure and contents of a file with no outside information. One HDF file can hold a mix of related objects which can be accessed as a group or as individual objects.</p>
<p>The <code>to_hdf()</code> method in Pandas uses the <code>HDFStore</code> in the background, which in turn utilizes the <a href="https://www.pytables.org/">PyTables</a> library.</p>
<ul>
<li>Advantages:
<ul>
<li>universal, cross language</li>
<li>preserves types</li>
<li>can store multiple <code>DataFrame</code>s</li>
</ul></li>
<li>Disadvantages:
<ul>
<li>large file size</li>
<li>requires <code>tables</code> package to be installed (PyTables)</li>
<li>slow (?)</li>
<li>unsafe (because of serializing object-dtype data with pickle)</li>
</ul></li>
</ul>
<hr>
<p><u>Storing NetworkX DiGraph directly</u></p>
<p>Except for the adjacency lists format (<strong>*.adjlist.txt</strong>), which cannot store any additional data (not even per-edge), the multi-line adjacency lists (<strong>*.multiline_adjlist.txt</strong>) and edge lists (<strong>*.edgelist.txt</strong>) formats have file sizes larger than the Parquet storing <code>DataFrame</code> of edge lists. Note however that they are uncompressed.</p>
<p>The adjacency list format can be created directly by appropriate Git command.</p>
<p>Because those formats cannot store per-node data, they are not considered for use.</p>
<p>Among specialized graph file formats, which I assume can store both per-node and per-edge data, <strong><em>Pajek</em></strong> format is smallest (compressed), and 4th smallest among all considered storage formats. It is also smallest uncompressed among similar file formats.</p>
<p>Writing NetworkX graphs as Python pickles using <code>write_gpickle()</code> (*<strong>.gpickle.gz</strong>) results in quite large file compressed, one of the largest files uncompressed.</p>
<p>On the other hand NetworkX graphs can contain any hashable Python object as node (not just integers and strings). For arbitrary data types it may be difficult to represent the data as text. In that case using Python pickles to store the graph data can be used.</p>
</section>
</section>
<section id="examining-computing-and-storing-reachability-labels-and-other-per-node-data" class="level2">
<h2 class="anchored" data-anchor-id="examining-computing-and-storing-reachability-labels-and-other-per-node-data">Examining computing and storing reachability labels and other per-node data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> git_commit_graph_ext.labelling.levels <span class="im">import</span> <span class="op">*</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> git_commit_graph_ext.labelling.dfs_intervals <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="computing-reachability-labels-for-git.git-commit-graph" class="level3">
<h3 class="anchored" data-anchor-id="computing-reachability-labels-for-git.git-commit-graph">Computing reachability labels for git.git commit graph</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'git.git commit graph'</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> graph_git</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'graph has </span><span class="sc">{}</span><span class="st"> nodes and </span><span class="sc">{}</span><span class="st"> edges'</span>.<span class="bu">format</span>(graph.number_of_nodes(), graph.number_of_edges()))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">find levels:'</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">find min-post intervals:'</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">find min-post intervals (graph+tree):'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>git.git commit graph
graph has 63829 nodes and 79664 edges

find levels:
Wall time: 669 ms

find min-post intervals:
Wall time: 1.93 s

find min-post intervals (graph+tree):
Wall time: 1.68 s</code></pre>
</div>
</div>
<p>All times to calculate different graph indices for git.git commit graph take around few second.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculating parameters of the git.git commit graphs: distribution of in-degree, out-degree and level</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'git.git commit graph'</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> graph_git</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>graph_info_df<span class="op">=</span>pd.DataFrame.from_dict(graph.lvl,orient<span class="op">=</span><span class="st">'index'</span>).rename(columns<span class="op">=</span>{<span class="dv">0</span>: <span class="st">'level'</span>})</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>graph_info_df.index.name<span class="op">=</span><span class="st">'node'</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>graph_info_df[<span class="st">'in degree'</span>]<span class="op">=</span>pd.Series(<span class="bu">dict</span>(graph.in_degree()))</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>graph_info_df[<span class="st">'out degree'</span>]<span class="op">=</span>pd.Series(<span class="bu">dict</span>(graph.out_degree()))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>graph_info_df[<span class="st">'degree'</span>]<span class="op">=</span>graph_info_df[<span class="st">'in degree'</span>]<span class="op">+</span>graph_info_df[<span class="st">'out degree'</span>]</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>graph_info_df <span class="op">=</span> pd.concat([graph_info_df,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>                           pd.DataFrame.from_dict(graph.mpi_ext,orient<span class="op">=</span><span class="st">'index'</span>,columns<span class="op">=</span>[<span class="st">'f_min'</span>,<span class="st">'min'</span>,<span class="st">'post'</span>])],</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>                          axis<span class="op">=</span><span class="dv">1</span>,join<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>graph_info_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>git.git commit graph</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">level</th>
<th data-quarto-table-cell-role="th">in degree</th>
<th data-quarto-table-cell-role="th">out degree</th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">f_min</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">post</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">e83c51633</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8bc9a0c76</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">e497ea2a9</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bf0c6e839</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19b2860cb</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">e6d102643</td>
<td>21094</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63825</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4c6c5054a</td>
<td>21095</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63826</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">f29945cb3</td>
<td>21096</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63827</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">b16af9417</td>
<td>21097</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63828</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">45daf8777</td>
<td>21098</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>63662</td>
<td>63829</td>
</tr>
</tbody>
</table>

<p>63829 rows × 7 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>graph_info_df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>level         int64
in degree     int64
out degree    int64
degree        int64
f_min         int64
min           int64
post          int64
dtype: object</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>graph_info_df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['level', 'in degree', 'out degree', 'degree', 'f_min', 'min', 'post'], dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>graph_info_df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">level</th>
<th data-quarto-table-cell-role="th">in degree</th>
<th data-quarto-table-cell-role="th">out degree</th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">f_min</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">post</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>11774.655439</td>
<td>1.248085</td>
<td>1.248085</td>
<td>2.496169</td>
<td>2122.979116</td>
<td>23913.162168</td>
<td>31915.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>6198.793361</td>
<td>1.556817</td>
<td>0.436128</td>
<td>1.602244</td>
<td>10631.734068</td>
<td>21750.776061</td>
<td>18425.989503</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>7003.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>15958.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>12695.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>1.000000</td>
<td>21878.000000</td>
<td>31915.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>17120.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>1.000000</td>
<td>43554.000000</td>
<td>47872.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>21136.000000</td>
<td>110.000000</td>
<td>10.000000</td>
<td>111.000000</td>
<td>62308.000000</td>
<td>63662.000000</td>
<td>63829.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The git.git repository (state for December 2020) has, in all its branches - around 64k commits - maximum level of around 21k (around 1/3 of number of commits) - mean out-degree of 1.25</p>
</section>
<section id="visualizing-topological-level-stats-for-git.git-commit-graph" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-topological-level-stats-for-git.git-commit-graph">Visualizing topological level stats for git.git commit graph</h3>
<p>Imports for plots</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Histogram for backward topological levels</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Histogram of levels'</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Level'</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>graph_info_df[<span class="st">'level'</span>].plot.hist(bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>plt.draw()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-38-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Plot of counts for backward topological levels</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>level_counts<span class="op">=</span>graph_info_df[<span class="st">'level'</span>].value_counts()</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>level_counts_df<span class="op">=</span>pd.DataFrame({<span class="st">'level counts'</span>: level_counts})</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>level_counts_df.index.name<span class="op">=</span><span class="st">'level'</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>level_counts_df.sort_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>level_counts_df.plot()</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'</span><span class="sc">%s</span><span class="st"> commit graph - number of nodes with given level'</span> <span class="op">%</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">'git.git'</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'level of node / vertex'</span>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'number of nodes / vertices'</span>)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-39-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Histogram of counts for backward topological levels</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>level_counts<span class="op">=</span>graph_info_df[<span class="st">'level'</span>].value_counts()</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Histogram of level counts</span><span class="ch">\n</span><span class="st">'</span><span class="op">+</span><span class="st">'Number of levels with given count of nodes'</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Level value count</span><span class="ch">\n</span><span class="st">'</span><span class="op">+</span><span class="st">'number of commits with given level'</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>level_counts.plot.hist(bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>level_counts.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>count    21137.000000
mean         3.019776
std          3.477064
min          1.000000
25%          1.000000
50%          2.000000
75%          4.000000
max        112.000000
Name: level, dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-40-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Sanity checking the computed level counts; nodes with backward topological level of zero are sink nodes, with out-degree of 0.</p>
<p>Thus the number of nodes with level of 0 should be equal to number of nodes with out-degree of 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sanity checking level counts</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'git.git commit graph'</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> graph_git</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>sinks  <span class="op">=</span>[n <span class="cf">for</span> n <span class="kw">in</span> graph <span class="cf">if</span> graph.out_degree(n) <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>sources<span class="op">=</span>[n <span class="cf">for</span> n <span class="kw">in</span> graph <span class="cf">if</span> graph.in_degree(n)  <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'there are </span><span class="sc">{:3d}</span><span class="st"> nodes with  in-degree of 0'</span>.<span class="bu">format</span>(<span class="bu">len</span>(sources)))</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'there are </span><span class="sc">{:3d}</span><span class="st"> nodes with out-degree of 0: </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="bu">len</span>(sinks),sinks))</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'there are </span><span class="sc">{:3d}</span><span class="st"> nodes with level of 0'</span>.<span class="bu">format</span>(level_counts.at[<span class="dv">0</span>]))</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>graph_info_df[graph_info_df[<span class="st">'level'</span>]<span class="op">==</span><span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>git.git commit graph
there are   3 nodes with  in-degree of 0
there are   9 nodes with out-degree of 0: ['7d77f2e9c', '1bd90415d', '0ca71b373', '16d6b8ab6', 'cb07fc2a2', '161332a52', '2744b2344', '1db95b00a', 'e83c51633']
there are   9 nodes with level of 0</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">level</th>
<th data-quarto-table-cell-role="th">in degree</th>
<th data-quarto-table-cell-role="th">out degree</th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">f_min</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">post</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">e83c51633</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1db95b00a</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>799</td>
<td>799</td>
<td>799</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2744b2344</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1149</td>
<td>1149</td>
<td>1149</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">161332a52</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>5044</td>
<td>5044</td>
<td>5044</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">cb07fc2a2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>8137</td>
<td>8137</td>
<td>8137</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16d6b8ab6</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>10300</td>
<td>10300</td>
<td>10300</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0ca71b373</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>28384</td>
<td>28384</td>
<td>28384</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1bd90415d</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>61749</td>
<td>61749</td>
<td>61749</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7d77f2e9c</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>62308</td>
<td>62308</td>
<td>62308</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="visualizing-in-degree-and-out-degree-in-git.git-commit-graph" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-in-degree-and-out-degree-in-git.git-commit-graph">Visualizing in-degree and out-degree in git.git commit graph</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>graph_info_df[[<span class="st">'in degree'</span>,<span class="st">'out degree'</span>]].hist(bins<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-42-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'in degree'</span>,<span class="st">'out degree'</span>],bins<span class="op">=</span><span class="dv">10</span>,<span class="bu">range</span><span class="op">=</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-43-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>graph_info_df[[<span class="st">'in degree'</span>,<span class="st">'out degree'</span>]].plot.hist(bins<span class="op">=</span><span class="dv">51</span>,alpha<span class="op">=</span><span class="fl">0.4</span>,<span class="bu">range</span><span class="op">=</span>(<span class="dv">0</span>,<span class="dv">50</span>))</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-44-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>For a graph that follows the power law (for example small-world or scale-free graphs), the distribution of degrees should be a straight line on log-log scale.</p>
<p>For example the plot below (taken from the KONECT handbook, Figure 7a) shows the degree distribution and cumulative degree distribution for the Wikipedia election network (<a href="http://konect.cc/networks/elec/">EL</a>).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/konect/KONECT_handbook-fig_7a-degree_distribution_Wikipedia_election_network.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">The degree distribution and cumulative degree distribution for the Wikipedia election network (EL)</figcaption>
</figure>
</div>
<p>Below there is the same graph for the commit graph of the git.git repository</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>degree_count_df<span class="op">=</span>graph_info_df[<span class="st">'degree'</span>].value_counts(sort<span class="op">=</span><span class="va">False</span>)<span class="op">\</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                    .to_frame(name<span class="op">=</span><span class="st">'Frequency'</span>).rename_axis(<span class="st">'degree'</span>)<span class="op">\</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                    .sort_index()</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>degree_count_df[<span class="st">'Degree (d)'</span>] <span class="op">=</span> degree_count_df.index</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>degree_count_df.plot(kind<span class="op">=</span><span class="st">'scatter'</span>,x<span class="op">=</span><span class="st">'Degree (d)'</span>,y<span class="op">=</span><span class="st">'Frequency'</span>,color<span class="op">=</span><span class="st">'#0000ff'</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                     figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">7</span>),logx<span class="op">=</span><span class="va">True</span>,logy<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                     title<span class="op">=</span><span class="st">'git.git commit graph'</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">'ticks'</span>, {<span class="st">"xtick.major.size"</span>: <span class="dv">20</span>, <span class="st">"ytick.major.size"</span>: <span class="dv">20</span>})</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="fl">.8</span>, <span class="fl">1e4</span>])</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="fl">1.</span>, <span class="fl">7e4</span>])</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co">#degree_count_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-45-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Note that degrees span the range up to around <span class="math inline">\(10^2\)</span> in the case of git.git commit graph, not <span class="math inline">\(10^4\)</span> of the Wikipedia elections network. Note also that degree of 1 is an outlier; it does not lie on the line through other points.</p>
<p>Below there is in/outdegree comparison plot for the git.git commit graph</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>graph_info_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">level</th>
<th data-quarto-table-cell-role="th">in degree</th>
<th data-quarto-table-cell-role="th">out degree</th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">f_min</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">post</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">e83c51633</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8bc9a0c76</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">e497ea2a9</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bf0c6e839</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19b2860cb</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">e6d102643</td>
<td>21094</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63825</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4c6c5054a</td>
<td>21095</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63826</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">f29945cb3</td>
<td>21096</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63827</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">b16af9417</td>
<td>21097</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63828</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">45daf8777</td>
<td>21098</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>63662</td>
<td>63829</td>
</tr>
</tbody>
</table>

<p>63829 rows × 7 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>grid<span class="op">=</span>sns.relplot(data<span class="op">=</span>graph_info_df,x<span class="op">=</span><span class="st">'out degree'</span>,y<span class="op">=</span><span class="st">'in degree'</span>,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                 kind<span class="op">=</span><span class="st">'scatter'</span>,color<span class="op">=</span><span class="st">'#0000ff'</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>grid.axes[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'git.git commit graph'</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ax.set_xscale('log')</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">#ax.set_yscale('log')</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-47-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="visualizing-min-post-intervals-in-git.git-commit-graphs" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-min-post-intervals-in-git.git-commit-graphs">Visualizing min-post intervals in git.git commit graphs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'f_min'</span>,<span class="st">'min'</span>],bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>graph_info_df[[<span class="st">'f_min'</span>,<span class="st">'min'</span>]].plot.hist(bins<span class="op">=</span><span class="dv">50</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-48-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-48-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Normalized intervals (interval divide by post-visit order number)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>graph_info_df[<span class="st">'|interval|'</span>]<span class="op">=</span>graph_info_df[<span class="st">'post'</span>] <span class="op">-</span> graph_info_df[<span class="st">'min'</span>]</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>graph_info_df[<span class="st">'|interval|/post'</span>]<span class="op">=</span>graph_info_df[<span class="st">'|interval|'</span>]<span class="op">/</span>graph_info_df[<span class="st">'post'</span>]</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>graph_info_df[<span class="st">'|f_interval|'</span>]<span class="op">=</span>graph_info_df[<span class="st">'post'</span>] <span class="op">-</span> graph_info_df[<span class="st">'f_min'</span>]</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>graph_info_df[<span class="st">'|f_interval|/post'</span>]<span class="op">=</span>graph_info_df[<span class="st">'|f_interval|'</span>]<span class="op">/</span>graph_info_df[<span class="st">'post'</span>]</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>graph_info_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">level</th>
<th data-quarto-table-cell-role="th">in degree</th>
<th data-quarto-table-cell-role="th">out degree</th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">f_min</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">post</th>
<th data-quarto-table-cell-role="th">|interval|</th>
<th data-quarto-table-cell-role="th">|interval|/post</th>
<th data-quarto-table-cell-role="th">|f_interval|</th>
<th data-quarto-table-cell-role="th">|f_interval|/post</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">e83c51633</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0.000000</td>
<td>0</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8bc9a0c76</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>0.500000</td>
<td>1</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">e497ea2a9</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>0.666667</td>
<td>2</td>
<td>0.666667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bf0c6e839</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>3</td>
<td>0.750000</td>
<td>3</td>
<td>0.750000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19b2860cb</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>5</td>
<td>4</td>
<td>0.800000</td>
<td>4</td>
<td>0.800000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">e6d102643</td>
<td>21094</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63825</td>
<td>163</td>
<td>0.002554</td>
<td>63824</td>
<td>0.999984</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4c6c5054a</td>
<td>21095</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63826</td>
<td>164</td>
<td>0.002569</td>
<td>63825</td>
<td>0.999984</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">f29945cb3</td>
<td>21096</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63827</td>
<td>165</td>
<td>0.002585</td>
<td>63826</td>
<td>0.999984</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">b16af9417</td>
<td>21097</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>63662</td>
<td>63828</td>
<td>166</td>
<td>0.002601</td>
<td>63827</td>
<td>0.999984</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">45daf8777</td>
<td>21098</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>63662</td>
<td>63829</td>
<td>167</td>
<td>0.002616</td>
<td>63828</td>
<td>0.999984</td>
</tr>
</tbody>
</table>

<p>63829 rows × 11 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>graph_info_df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">level</th>
<th data-quarto-table-cell-role="th">in degree</th>
<th data-quarto-table-cell-role="th">out degree</th>
<th data-quarto-table-cell-role="th">degree</th>
<th data-quarto-table-cell-role="th">f_min</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">post</th>
<th data-quarto-table-cell-role="th">|interval|</th>
<th data-quarto-table-cell-role="th">|interval|/post</th>
<th data-quarto-table-cell-role="th">|f_interval|</th>
<th data-quarto-table-cell-role="th">|f_interval|/post</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
<td>63829.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>11774.655439</td>
<td>1.248085</td>
<td>1.248085</td>
<td>2.496169</td>
<td>2122.979116</td>
<td>23913.162168</td>
<td>31915.000000</td>
<td>8001.837832</td>
<td>0.303827</td>
<td>29792.020884</td>
<td>0.947877</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>6198.793361</td>
<td>1.556817</td>
<td>0.436128</td>
<td>1.602244</td>
<td>10631.734068</td>
<td>21750.776061</td>
<td>18425.989503</td>
<td>15664.880755</td>
<td>0.458586</td>
<td>18603.735072</td>
<td>0.212082</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>7003.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>15958.000000</td>
<td>1.000000</td>
<td>0.000037</td>
<td>13660.000000</td>
<td>0.999923</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>12695.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>1.000000</td>
<td>21878.000000</td>
<td>31915.000000</td>
<td>7.000000</td>
<td>0.000282</td>
<td>29954.000000</td>
<td>0.999966</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>17120.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>1.000000</td>
<td>43554.000000</td>
<td>47872.000000</td>
<td>7365.000000</td>
<td>0.999864</td>
<td>45942.000000</td>
<td>0.999978</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>21136.000000</td>
<td>110.000000</td>
<td>10.000000</td>
<td>111.000000</td>
<td>62308.000000</td>
<td>63662.000000</td>
<td>63829.000000</td>
<td>61747.000000</td>
<td>0.999984</td>
<td>63828.000000</td>
<td>0.999984</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'min'</span>],bins<span class="op">=</span><span class="dv">50</span>,color<span class="op">=</span><span class="st">'m'</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'min'</span>],bins<span class="op">=</span><span class="dv">50</span>,log<span class="op">=</span><span class="va">True</span>,color<span class="op">=</span><span class="st">'m'</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'f_min'</span>],bins<span class="op">=</span><span class="dv">50</span>,color<span class="op">=</span><span class="st">'#800080'</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'f_min'</span>],bins<span class="op">=</span><span class="dv">50</span>,log<span class="op">=</span><span class="va">True</span>,color<span class="op">=</span><span class="st">'#800080'</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-51-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-51-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-51-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-51-output-4.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'|interval|'</span>],bins<span class="op">=</span><span class="dv">50</span>,log<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'|interval|/post'</span>],bins<span class="op">=</span><span class="dv">50</span>,log<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-52-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-52-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>graph_info_df[<span class="st">'|interval|/post'</span>].plot.kde(bw_method<span class="op">=</span><span class="fl">0.05</span>,ind<span class="op">=</span>np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">200</span>))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'kernel density estimator, bw=0.05, logscale'</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'|interval|/post'</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>plt.gca().set_yscale(<span class="st">"log"</span>, nonpositive<span class="op">=</span><span class="st">'clip'</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-53-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'|interval|/post'</span>],bins<span class="op">=</span><span class="dv">40</span>,log<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>graph_info_df[<span class="st">'|interval|/post'</span>].plot.kde(ind<span class="op">=</span>np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">500</span>),color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'histogram of relative size of the min-post tree interval</span><span class="ch">\n</span><span class="st">'</span><span class="op">+</span><span class="st">'kernel density estimator, logscale'</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'|interval|/post'</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>plt.gca().set_yscale(<span class="st">"log"</span>, nonpositive<span class="op">=</span><span class="st">'clip'</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-54-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'|f_interval|'</span>],bins<span class="op">=</span><span class="dv">50</span>,color<span class="op">=</span><span class="st">'g'</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'|f_interval|/post'</span>],bins<span class="op">=</span><span class="dv">50</span>,color<span class="op">=</span><span class="st">'c'</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>graph_info_df.hist(column<span class="op">=</span>[<span class="st">'|f_interval|/post'</span>],bins<span class="op">=</span><span class="dv">50</span>,log<span class="op">=</span><span class="va">True</span>,color<span class="op">=</span><span class="st">'c'</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-55-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-55-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="A.09_git_explore_files/figure-html/cell-55-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="storing-computed-reachability-labels-and-related-stats" class="level3">
<h3 class="anchored" data-anchor-id="storing-computed-reachability-labels-and-related-stats">Storing computed reachability labels and related stats</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shutil <span class="im">import</span> copyfile</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>copyfile(<span class="st">'datasets/git-commit_graph.df_edgelist.hdf5'</span>, <span class="st">'datasets/git-commit_graph.hdf5'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'datasets/git-commit_graph.hdf5'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'pickle.gz: '</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'csv.gz:    '</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'hdf (full):'</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'hdf (appd):'</span>, end<span class="op">=</span><span class="st">' '</span>, flush<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>pickle.gz:  Wall time: 3.8 s
csv.gz:     Wall time: 2.11 s
hdf (full): Wall time: 316 ms
hdf (appd): Wall time: 321 ms</code></pre>
</div>
</div>
<p>Saving to <code>pickle.gz</code> and <code>csv.gz</code> file format takes few seconds, saving to HDF file format takes less than 0.5s</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># feather does not support non-numerical index, IIRC</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co">#%time graph_info_df.to_feather('datasets/git-commit_graph.info.feather')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    graph_info_df.to_parquet(<span class="st">'datasets/git-commit_graph.info.parquet'</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">ImportError</span>:</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Missing optional dependency 'pyarrow' required"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wall time: 468 ms</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">"</span><span class="sc">{name:&lt;50}</span><span class="st"> </span><span class="sc">{size:&gt;7}</span><span class="st">"</span>.<span class="bu">format</span>(name<span class="op">=</span>p.name,size<span class="op">=</span>p.stat().st_size) <span class="cf">for</span> p <span class="kw">in</span> Path(<span class="st">"datasets"</span>).glob(<span class="st">"*.info.*"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['git-commit_graph.info.csv.gz                       1785780',
 'git-commit_graph.info.hdf5                         1382956',
 'git-commit_graph.info.parquet                      3164039',
 'git-commit_graph.info.pickle.gz                    1465333']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">"</span><span class="sc">{name:&lt;50}</span><span class="st"> </span><span class="sc">{size:&gt;7}</span><span class="st">"</span>.<span class="bu">format</span>(name<span class="op">=</span>p.name,size<span class="op">=</span>p.stat().st_size) <span class="cf">for</span> p <span class="kw">in</span> Path(<span class="st">"datasets"</span>).glob(<span class="st">"git-commit_graph.hdf5"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['git-commit_graph.hdf5                              3803473']</code></pre>
</div>
</div>
<p>Note that the sizes below are for <code>git log --all</code>, not current <code>git log --branches</code>, but the relative sizes should be similar</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>csv <span class="op">=</span> <span class="st">u"""filename;size [bytes];time [s]</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="st">datasets/git-commit_graph.info.pickle.gz;2833650;6.8</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="st">datasets/git-commit_graph.info.csv.gz;3681511;5.26</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="st">datasets/git-commit_graph.info.parquet;6079159;0.345 </span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="st">datasets/git-commit_graph.info.hdf5;2735986;0.674</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="st">datasets/git-commit_graph.hdf5;6548777;0.672</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>csv_stream <span class="op">=</span> io.StringIO(csv)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>table_sizes_2<span class="op">=</span>pd.read_csv(csv_stream,sep<span class="op">=</span><span class="st">';'</span>) <span class="co"># ,index_col=0</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>table_sizes_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">filename</th>
<th data-quarto-table-cell-role="th">size [bytes]</th>
<th data-quarto-table-cell-role="th">time [s]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>datasets/git-commit_graph.info.pickle.gz</td>
<td>2833650</td>
<td>6.800</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>datasets/git-commit_graph.info.csv.gz</td>
<td>3681511</td>
<td>5.260</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>datasets/git-commit_graph.info.parquet</td>
<td>6079159</td>
<td>0.345</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>datasets/git-commit_graph.info.hdf5</td>
<td>2735986</td>
<td>0.674</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>datasets/git-commit_graph.hdf5</td>
<td>6548777</td>
<td>0.672</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>table_sizes_2.sort_values(by<span class="op">=</span><span class="st">'size [bytes]'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">filename</th>
<th data-quarto-table-cell-role="th">size [bytes]</th>
<th data-quarto-table-cell-role="th">time [s]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>datasets/git-commit_graph.info.hdf5</td>
<td>2735986</td>
<td>0.674</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>datasets/git-commit_graph.info.pickle.gz</td>
<td>2833650</td>
<td>6.800</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>datasets/git-commit_graph.info.csv.gz</td>
<td>3681511</td>
<td>5.260</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>datasets/git-commit_graph.info.parquet</td>
<td>6079159</td>
<td>0.345</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>datasets/git-commit_graph.hdf5</td>
<td>6548777</td>
<td>0.672</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>table_sizes_2.sort_values(by<span class="op">=</span><span class="st">'time [s]'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">filename</th>
<th data-quarto-table-cell-role="th">size [bytes]</th>
<th data-quarto-table-cell-role="th">time [s]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>datasets/git-commit_graph.info.parquet</td>
<td>6079159</td>
<td>0.345</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>datasets/git-commit_graph.hdf5</td>
<td>6548777</td>
<td>0.672</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>datasets/git-commit_graph.info.hdf5</td>
<td>2735986</td>
<td>0.674</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>datasets/git-commit_graph.info.csv.gz</td>
<td>3681511</td>
<td>5.260</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>datasets/git-commit_graph.info.pickle.gz</td>
<td>2833650</td>
<td>6.800</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="summary-of-findings-1" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-findings-1">Summary of findings</h3>
<p>Strangely,smallest files size this time is given when storing using the <strong><em>HDF5</em></strong> (with <code>compresslevel=6</code>) format, which is also 2nd fastest.</p>
<p>Saving <code>DataFrame</code> using the <strong><em>Parquet</em></strong> format is fastest, but this time it gives the largest size of the file (except for <code>git-commit_graph.hdf5</code>, which stores both commit graph in edge list format, and per-node information)</p>
<p>Saving as <strong>*.pickle.gz</strong> or <strong>*.csv.gz</strong> is slowest and second slowest, while both being in the middlle with respect to file sizes (the pickle-based format gives smaller file size).</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>